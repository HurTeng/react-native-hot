__d(function(e,t,a,o){'use strict';Object.defineProperty(o,"__esModule",{value:!0});var i=t(46),s=babelHelpers.interopRequireDefault(i),l=t(12),r=t(338),n=babelHelpers.interopRequireDefault(r),p=t(524),d=babelHelpers.interopRequireDefault(p),h=t(511),u=(function(e){function t(e){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a._onError=function(e){console.log('\u9519\u8bef'+JSON.stringify(e))},a.state={toolsShowed:!0,paused:!1,curTime:0,wholeDuration:0,playableDuration:0,playState:0},a.controlBarWidth=246,a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentWillMount",value:function(){this.setState({wholeDuration:this.props.duration})}},{key:"loadStart",value:function(){}},{key:"loadHandle",value:function(){this.setState({toolsShowed:!1,playState:2})}},{key:"setTime",value:function(e){this.setState({curTime:e.currentTime,playableDuration:e.playableDuration})}},{key:"onEnd",value:function(){this.setState({toolsShowed:!0,paused:!0,curTime:0,playState:5})}},{key:"videoError",value:function(){l.ToastAndroid.show('\u62b1\u6b49\uff0c\u89c6\u9891\u51fa\u73b0\u9519\u8bef',l.ToastAndroid.SHORT)}},{key:"controlTools",value:function(){0===this.state.playState?this.setState({playState:1,toolsShowed:!0,paused:!1}):2!==this.state.playState&&3!==this.state.playState&&4!==this.state.playState||this.setState({toolsShowed:!1})}},{key:"play",value:function(){var e=this;0===this.state.playState?this.setState({playState:1,toolsShowed:!0,paused:!1}):this.setState({playState:2,paused:!1},function(){setTimeout(function(){e.setState({toolsShowed:!1})},2e3)})}},{key:"pause",value:function(){this.setState({playState:3,toolsShowed:!0,paused:!0})}},{key:"replay",value:function(){this.setState({toolsShowed:!0,paused:!1,curTime:0,playState:0})}},{key:"pressVideoHandle",value:function(){this.setState({toolsShowed:!0})}},{key:"changeProgress",value:function(e){var t=e.nativeEvent.locationX/this.controlBarWidth,a=this.state.wholeDuration*t;this.refs.videoPlayer.seek(a)}},{key:"render",value:function(){return s.default.createElement(l.View,{style:{height:this.props.height}},s.default.createElement(l.Image,{style:{width:'100%',height:this.props.height,position:'absolute',top:0,left:0},source:{uri:this.props.img},resizeMode:"stretch"}),0===this.state.playState?s.default.createElement(l.Image,{style:{width:'100%',height:this.props.height,position:'absolute',top:0,left:0},source:{uri:this.props.img},resizeMode:"stretch"}):s.default.createElement(l.TouchableOpacity,{activeOpacity:1,onPress:this.pressVideoHandle.bind(this)},s.default.createElement(d.default,{ref:"videoPlayer",source:{uri:this.props.source},rate:1,volume:1,muted:!1,paused:this.state.paused,resizeMode:"cover",repeat:!1,onLoadStart:this.loadStart.bind(this),onLoad:this.loadHandle.bind(this),onProgress:this.setTime.bind(this),onEnd:this.onEnd.bind(this),onError:this._onError,style:{height:this.props.height}})),s.default.createElement(l.TouchableOpacity,{activeOpacity:.9,onPress:this.controlTools.bind(this),style:{display:this.state.toolsShowed?'flex':'none',width:'100%',height:this.props.height,position:'absolute',top:0,left:0,paddingTop:(0,h.px2dp)(6),justifyContent:'space-between'}},s.default.createElement(l.Text,{style:{color:'#fff',marginLeft:(0,h.px2dp)(6),marginRight:(0,h.px2dp)(6)}},this.props.title),0===this.state.playState||3===this.state.playState?s.default.createElement(n.default,{onPress:this.play.bind(this),style:c.playIcon,name:"play-arrow"}):1===this.state.playState||4===this.state.playState?s.default.createElement(l.ActivityIndicator,{color:"white",size:26}):2===this.state.playState?s.default.createElement(n.default,{onPress:this.pause.bind(this),style:c.playIcon,name:"pause"}):s.default.createElement(n.default,{onPress:this.replay.bind(this),style:c.playIcon,name:"cached"}),0===this.state.playState||5===this.state.playState?s.default.createElement(l.View,{style:c.duartion},s.default.createElement(l.Text,{style:c.duartionText},(0,h.formatTime)(this.state.wholeDuration))):s.default.createElement(l.TouchableOpacity,{activeOpacity:1,style:c.controlBar,onPress:function(){}},s.default.createElement(l.Text,{style:c.controlBarText},(0,h.formatTime)(Math.floor(this.state.curTime))),s.default.createElement(l.View,{style:c.controlBarBar,onStartShouldSetResponder:function(e){return!0},onMoveShouldSetResponder:function(e){return!0},onResponderGrant:this.changeProgress.bind(this)},s.default.createElement(l.View,{style:c.wholeProgress}),s.default.createElement(l.View,{style:[c.playableProgress,{width:this.state.playableDuration/this.state.wholeDuration*100+'%'}]}),s.default.createElement(l.View,{style:[c.playedProgress,{width:this.state.curTime/this.state.wholeDuration*100+'%'}]}),s.default.createElement(l.View,{style:[c.circle,{left:this.state.curTime/this.state.wholeDuration*100+'%'}]})),s.default.createElement(l.Text,{style:c.controlBarText},(0,h.formatTime)(this.state.wholeDuration)))))}}]),t})(i.Component);o.default=u;var c=l.StyleSheet.create({videoImg:{},video:{},playIcon:{color:'#fff',alignSelf:'center',fontSize:(0,h.px2dp)(50)},duartion:{alignSelf:'flex-end',width:(0,h.px2dp)(46),height:(0,h.px2dp)(17),borderRadius:(0,h.px2dp)(10),backgroundColor:'rgba(0,0,0,0.5)',marginRight:(0,h.px2dp)(8),marginBottom:(0,h.px2dp)(8),justifyContent:'center',alignItems:'center'},duartionText:{color:'#fff',fontSize:(0,h.px2dp)(10)},controlBar:{width:'100%',height:(0,h.px2dp)(40),backgroundColor:'rgba(0,0,0,0.8)',flexDirection:'row',alignItems:'center',paddingLeft:(0,h.px2dp)(6),paddingRight:(0,h.px2dp)(6),justifyContent:'space-between'},controlBarBar:{flex:1,marginLeft:(0,h.px2dp)(22),marginRight:(0,h.px2dp)(22),height:'100%'},wholeProgress:{position:'absolute',top:'49%',height:(0,h.px2dp)(4),width:'100%',backgroundColor:'rgba(255,255,255,0.4)',borderRadius:(0,h.px2dp)(6)},playableProgress:{position:'absolute',top:'49%',height:(0,h.px2dp)(4),backgroundColor:'rgba(255,255,255,0.5)',borderRadius:(0,h.px2dp)(6)},playedProgress:{position:'absolute',top:'49%',height:(0,h.px2dp)(4),backgroundColor:'#d33d3c',borderRadius:(0,h.px2dp)(6)},circle:{width:(0,h.px2dp)(14),height:(0,h.px2dp)(14),backgroundColor:'#fff',borderRadius:(0,h.px2dp)(100),position:'absolute',top:'38%'},controlBarText:{color:'white',fontSize:(0,h.px2dp)(12)}})},523);